## 战斗系统

在上一课中，我们了解了经济系统设计。本课中，我们将学习游戏中的另一个核心概念——战斗系统。

在这个游戏中，城堡可以与其他城堡进行战斗。战斗机制涉及随机性、战斗力确定、胜者奖励、败者惩罚和战斗冷却。

1. 随机敌人
    在进行战斗计算之前，每个开始战斗的城堡都需要从不在战斗冷却期的城堡池中随机挑选一个对手。

2. 战斗力
    每个城堡都有其基础战斗力——基础攻击力和基础防御力，它们由城堡的种族、尺寸和等级决定。

    与经济力类似，士兵也可以提供额外的攻击力和防御力。不同种族的士兵可以提供不同的攻击和防御加成。

3. 战斗结果确定
    要确定战斗中的胜者和败者，必须比较攻击方的总体攻击力和防御方的总体防御力。
    ```
    总体攻击力 = 基础攻击力 + 士兵的额外攻击力
    总体防御力 = 基础防御力 + 士兵的额外防御力
    ```
    除了总体战斗力之外，在战斗结果确定过程中，双方之间还存在种族优势。

    ![战斗](../01_游戏设计/images/01-02.png?raw=true)
    
    在战斗中拥有种族优势的一方，其战斗力将会按比例增加。例如，当人类城堡攻击精灵城堡时，攻击方的总体攻击力将增加50%。另一方面，当精灵城堡攻击人类城堡时，防御方的总体防御力将增加50%。

4. 战斗赔款
    当胜者确定后，胜者将在一段时间内获得败者的经济利益。在此期间，败者的基础经济力将为0，而胜者将拥有败者基础经济力的附加经济力。

5. 士兵伤亡
    城堡的士兵也会参与城堡之间的战斗，当然他们也会遭受伤亡。

6. 战斗冷却
    战斗结束后，双方都会进入战斗冷却期，在此期间无法开始新的战斗，也不会受到攻击。